:numbered:
[[mod_locations_locations_module]]
== _Locations_ module

*Module Identifier: `locations`*

The Location objects live in the CPO back-end system. They describe the charging locations of that operator.

*Module dependency:* the eMSP endpoint is dependent on the <<mod_tariffs.asciidoc#mod_tariffs_tariffs_module,Tariffs module>>

[[mod_locations_flow_and_lifecycle]]
=== Flow and Lifecycle

The Locations module has Locations as base object, Locations have EVSEs, EVSEs have Connectors. With the methods in the <<mod_locations_emsp_interface,eMSP interface>>, Location information/statuses can be shared with the eMSP. Updates can be done to the Location, but also to only an EVSE or a Connector.

When a CPO creates Location objects it pushes them to the eMSPs by calling <<mod_locations_put_method,PUT>> on the eMSPs Locations endpoint. Providers who do not support push mode need to call <<mod_locations_get_method,GET>> on the CPOs Locations endpoint to receive the new object.

If the CPO wants to replace a Location related object, they push it to the eMSP systems by calling <<mod_locations_put_method,PUT>> on their Locations endpoint.

Any changes to a Location related object can also be pushed to the eMSP by calling the <<mod_locations_patch_method,PATCH>> on the eMSPs Locations endpoint. Providers who do not support push mode need to call <<mod_locations_get_method,GET>> on the CPOs Locations endpoint to receive the updates.

When the CPO wants to delete an EVSE they must update by setting the `status` field to `REMOVED` and call the <<mod_locations_put_method,PUT>> or <<mod_locations_patch_method,PATCH>> on the eMSP system. A _Location_ without valid _EVSE_ objects can be considered as expired and should no longer be displayed. There is no direct way to delete a location.

When the CPO is not sure about the state or existence of a Location, EVSE or Connector object in the eMSPs system, the CPO can call the <<mod_locations_get_method_eMSP,GET>> to validate the object in the eMSP system. 

[[mod_locations_interfaces_and_endpoints]]
=== Interfaces and endpoints

There is both a CPO and an eMSP interface for Locations. Advised is to use the push direction from CPO to eMSP during normal operation.
The CPO interface is meant to be used when the connection between 2 parties is established, to retrieve the current list of Location objects with the current status, and when the eMSP is not 100% sure the Locations cache is completely correct.
The eMSP can use the CPO GET Object interface to retrieve a specific Location, EVSE or Connector, this might be used by a eMSP that wants information about a specific Location, but has not implemented the eMSP Locations interface (cannot receive push).

[[mod_locations_cpo_interface]]
==== CPO Interface

Example endpoint structure: `/ocpi/cpo/2.0/locations`

[cols="2,12",options="header"]
|===
|Method |Description 

|<<mod_locations_get_method,GET>> |Fetch a list locations, last updated between the {date_from} and {date_to} (<<transport_and_format.asciidoc#transport_and_format_pagination,paginated>>), or get a specific location, EVSE or Connector. 
|POST |n/a 
|PUT |n/a 
|PATCH |n/a 
|DELETE |n/a 
|===

[[mod_locations_get_method]]
===== *GET* Method

Depending on the URL Segments provided, the GET request can either be used to retrieve
information about a list of available locations and EVSEs at this CPO: <<mod_locations_get_list_request_parameters,GET List>>
Or it can be used to get information about a specific Location, EVSE or Connector: <<mod_locations_get_object_request_parameters,GET Object>>

[[mod_locations_get_list_request_parameters]]
====== GET List Request Parameters

Example endpoint structures for retrieving a list of Locations:
`/ocpi/cpo/2.0/locations/?date_from=xxx&amp;date_to=yyy`
`/ocpi/cpo/2.0/locations/?offset=50`
`/ocpi/cpo/2.0/locations/?limit=100`
`/ocpi/cpo/2.0/locations/?offset=50&amp;limit=100`

If additional parameters: {date_from} and/or {date_to} are provided, only Locations with (`last_updated`) between the given date_from and date_to will be returned.
If an EVSE is updated, also the 'parent' Location's `last_updated` fields is updated. If a Connector is updated, the EVSE's `last_updated` and the Location's `last_updated` field are updated.

This request is <<transport_and_format.asciidoc#transport_and_format_pagination,paginated>>, it supports the <<transport_and_format.asciidoc#transport_and_format_paginated_request,pagination>> related URL parameters.

[cols="3,2,1,10",options="header"]
|===
|Parameter |Datatype |Required |Description 

|date_from |<<types.asciidoc#types_datetime_type,DateTime>> |no |Only return Locations that have `last_updated` after this Date/Time. 
|date_to |<<types.asciidoc#types_datetime_type,DateTime>> |no |Only return Locations that have `last_updated` before this Date/Time. 
|offset |int |no |The offset of the first object returned. Default is 0. 
|limit |int |no |Maximum number of objects to GET. 
|===

[[mod_locations_get_list_response_data]]
====== GET List Response Data

The endpoint returns a list of Location objects
the header will contain the <<transport_and_format.asciidoc#transport_and_format_paginated_response,pagination>> related headers.

Any older information that is not specified in the response is considered no longer valid.
Each object must contain all required fields. Fields that are not specified may be considered as null values.

[cols="4,1,12",options="header"]
|===
|Type |Card. |Description 

|<<mod_locations_location_object,Location>> |* |List of all locations with valid EVSEs. 
|===

[[mod_locations_get_object_request_parameters]]
====== GET Object Request Parameters

Example endpoint structures for a specific Location, EVSE or Connector:
`/ocpi/cpo/2.0/locations/{location_id}`
`/ocpi/cpo/2.0/locations/{location_id}/{evse_uid}`
`/ocpi/cpo/2.0/locations/{location_id}/{evse_uid}/{connector_id}`

The following parameters can be provided as URL segments.

[cols="3,2,1,10",options="header"]
|===
|Parameter |Datatype |Required |Description 

|location_id |<<types.asciidoc#types_string_type,string>>(39) |yes |Location.id of the Location object to retrieve. 
|evse_uid |<<types.asciidoc#types_string_type,string>>(39) |no |Evse.uid, required when requesting an EVSE or Connector object. 
|connector_id |<<types.asciidoc#types_string_type,string>>(36) |no |Connector.id, required when requesting a Connector object. 
|===

[[mod_locations_get_object_response_data]]
====== GET Object Response Data

The response contains the requested object. 

[cols="4,1,12",options="header"]
|===
|Type |Card. |Description 

|_Choice: one of three_ | | 
|&gt; <<mod_locations_location_object,Location>> |1 |If a Location object was requested: the Location object. 
|&gt; <<mod_locations_evse_object,Location>> |1 |If an EVSE object was requested: the EVSE object. 
|&gt; <<mod_locations_connector_object,Connector>> |1 |If a Connector object was requested: the Connector object. 
|===


[[mod_locations_emsp_interface]]
===== eMSP Interface

Locations is a <<transport_and_format.asciidoc#transport_and_format_client_owned_object_push,client owned object>>, so the end-points need to contain the required extra fields: {<<credentials.asciidoc#credentials_credentials_object,party_id>>} and {<<credentials.asciidoc#credentials_credentials_object,country_code>>}.
Example endpoint structures:
`/ocpi/emsp/2.0/locations/{country_code}/{party_id}/{location_id}`
`/ocpi/emsp/2.0/locations/{country_code}/{party_id}/{location_id}/{evse_uid}`
`/ocpi/emsp/2.0/locations/{country_code}/{party_id}/{location_id}/{evse_uid}/{connector_id}`

[cols="2,12",options="header"]
|===
|Method |Description 

|<<mod_locations_get_method_eMSP,GET>> |Retrieve a Location as it is stored in the eMSP system. 
|POST |n/a _(use <<mod_locations_put_method,PUT>>)_ 
|<<mod_locations_put_method,PUT>> |Push new/updated Location, EVSE and/or Connectors to the eMSP 
|<<mod_locations_patch_method,PATCH>> |Notify the eMSP of partial updates to a Location, EVSEs or Connector (such as the status). 
|DELETE |n/a _(use <<mod_locations_patch_method,PATCH>>)_ 
|===

[[mod_locations_get_method_eMSP]]
===== *GET* Method

If the CPO wants to check the status of a Location, EVSE or Connector object in the eMSP system, it might GET the object from the eMSP system for validation purposes. The CPO is the owner of the objects, so it would be illogical if the eMSP system had a different status or was missing an object. If a discrepancy is found, the CPO might push an update to the eMSP via a <<mod_locations_put_method,PUT>> or <<mod_locations_patch_method,PATCH>> call.

[[mod_locations_request_parameters]]
====== Request Parameters

The following parameters can be provided as URL segments.

[cols="3,2,1,10",options="header"]
|===
|Parameter |Datatype |Required |Description 

|country_code |<<types.asciidoc#types_string_type,string>>(2) |yes |Country code of the CPO requesting this PUT to the eMSP system. 
|party_id |<<types.asciidoc#types_string_type,string>>(3) |yes |Party ID (Provider ID) of the CPO requesting this PUT to the eMSP system. 
|location_id |<<types.asciidoc#types_string_type,string>>(39) |yes |Location.id of the Location object to retrieve. 
|evse_uid |<<types.asciidoc#types_string_type,string>>(39) |no |Evse.uid, required when requesting an EVSE or Connector object. 
|connector_id |<<types.asciidoc#types_string_type,string>>(36) |no |Connector.id, required when requesting a Connector object. 
|===

[[mod_locations_response_data]]
====== Response Data

The response contains the requested object. 

[cols="4,1,12",options="header"]
|===
|Type |Card. |Description 

|_Choice: one of three_ | | 
|&gt; <<mod_locations_location_object,Location>> |1 |If a Location object was requested: the Location object. 
|&gt; <<mod_locations_evse_object,Location>> |1 |If an EVSE object was requested: the EVSE object. 
|&gt; <<mod_locations_connector_object,Connector>> |1 |If a Connector object was requested: the Connector object. 
|===


[[mod_locations_put_method]]
===== *PUT* Method

The CPO pushes available Location/EVSE or Connector objects to the eMSP. PUT is used to send new Location objects to the eMSP, or to replace existing Locations.

[[mod_locations_request_parameters_msp]]
====== Request Parameters

This is an information push message, the objects pushed will not be owned by the eMSP. To make distinctions between objects being pushed to an eMSP from different CPOs, the {<<credentials.asciidoc#credentials_credentials_object,party_id>>} and {<<credentials.asciidoc#credentials_credentials_object,country_code>>} have to be included in the URL, as URL segments.

[cols="3,2,1,10",options="header"]
|===
|Parameter |Datatype |Required |Description 

|country_code |<<types.asciidoc#types_string_type,string>>(2) |yes |Country code of the CPO requesting this PUT to the eMSP system. 
|party_id |<<types.asciidoc#types_string_type,string>>(3) |yes |Party ID (Provider ID) of the CPO requesting this PUT to the eMSP system. 
|location_id |<<types.asciidoc#types_string_type,string>>(39) |yes |Location.id of the new Location object, or the Location of which an EVSE or Location object is send 
|evse_uid |<<types.asciidoc#types_string_type,string>>(39) |no |Evse.uid, required when an EVSE or Connector object is send/replaced. 
|connector_id |<<types.asciidoc#types_string_type,string>>(36) |no |Connector.id, required when a Connector object is send/replaced. 
|===

[[mod_locations_request_body]]
====== Request Body

The request contains the new/updated object.

[cols="4,1,12",options="header"]
|===
|Type |Card. |Description 

|_Choice: one of three_ | | 
|&gt; <<mod_locations_location_object,Location>> |1 |New Location object, or Location object to replace. 
|&gt; <<mod_locations_evse_object,Location>> |1 |New EVSE object, or EVSE object to replace. 
|&gt; <<mod_locations_connector_object,Connector>> |1 |New Connector object, or Connector object to replace. 
|===

[[mod_locations_patch_method]]
===== *PATCH* Method

Same as the <<mod_locations_put_method,PUT>> method, but only the fields/objects that have to be updated have to be present, other fields/objects that are not specified are considered unchanged.

[[mod_locations_example_a_simple_status_update]]
====== Example: a simple status update

This is the most common type of update message to notify eMSPs that an EVSE (EVSE with uid 3255 of Charge Point 1012) is now occupied.

[source,json]
----
PATCH To URL: https://www.server.com/ocpi/emsp/2.0/locations/NL/TNM/1012/3255

{
	"status": "CHARGING"
}
----

[[mod_locations_example_change_the_location_name]]
====== Example: change the location name

In this example the name of location 1012 is updated.

[source,json]
----
PATCH To URL: https://www.server.com/ocpi/emsp/2.0/locations/NL/TNM/1012

{
	"name": "Interparking Gent Zuid"
}
----

[[mod_locations_example_set_tariff_update]]
====== Example: set tariff update

In this example connector 2 of EVSE 1 of Charge Point 1012, receives a new pricing scheme.

[source,json]
----
PATCH To URL: https://www.server.com/ocpi/emsp/2.0/locations/NL/TNM/1012/3255/2

{
    "tariff_id": "15"
}
----

[[mod_locations_example_add_an_evse]]
====== Example: add an EVSE

To add an _EVSE_, simply put the full object in an update message, including all its required fields. Since the id is new, the receiving party will know that it is a new object. When not all required fields are specified, the object may be discarded.

[source,json]
----
PUT To URL: https://www.server.com/ocpi/emsp/2.0/locations/NL/TNM/1012/3256

{
	"uid": "3256",
	"evse_id": "BE*BEC*E041503003",
	"status": "AVAILABLE",
	"capabilities": ["RESERVABLE"],
	"connectors": [
		{
			"id": "1",
			"standard": "IEC_62196_T2",
			"format": "SOCKET",
			"tariff_id": "14"
		}
	],
	"physical_reference": 3,
	"floor": -1
}
----

[[mod_locations_example_delete_an_evse]]
====== Example: delete an EVSE

An EVSE can be deleted by updating its _status_ property.

[source,json]
----
PATCH To URL: https://www.server.com/ocpi/emsp/2.0/locations/NL/TNM/1012/3256

{
	"status": "REMOVED"
}
----

_Note: To inform that an EVSE is scheduled for removal, the
status_schedule field can be used._

[[mod_locations_object_description]]
=== Object description

Location, EVSE and Connector have the following relation.

.Location class diagram
image::images/locations-class-diagram.svg[Location class diagram]

[[mod_locations_location_object]]
==== _Location_ Object

The _Location_ object describes the location and its properties where a group of EVSEs that belong together are installed. Typically the _Location_ object is the exact location of the group of EVSEs, but it can also be the entrance of a parking garage which contains these EVSEs. The exact way to reach each EVSE can be further specified by its own properties.

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description 

|id |<<types.asciidoc#types_string_type,string>>(39) |1 |Uniquely identifies the location within the CPOs platform (and suboperator platforms). This field can never be changed, modified or renamed. 
|type |<<mod_locations_locationtype_enum,LocationType>> |1 |The general type of the charge point location. 
|name |<<types.asciidoc#types_string_type,string>>(255) |? |Display name of the location. 
|address |<<types.asciidoc#types_string_type,string>>(45) |1 |Street/block name and house number if available. 
|city |<<types.asciidoc#types_string_type,string>>(45) |1 |City or town. 
|postal_code |<<types.asciidoc#types_string_type,string>>(10) |1 |Postal code of the location. 
|country |<<types.asciidoc#types_string_type,string>>(3) |1 |ISO 3166-1 alpha-3 code for the country of this location. 
|coordinates |<<mod_locations_geolocation_class,GeoLocation>> |1 |Coordinates of the location. 
|related_locations |<<mod_locations_additionalgeolocation_class,AdditionalGeoLocation>> |* |Geographical location of related points relevant to the user. 
|evses |<<mod_locations_evse_object,Location>> |* |List of EVSEs that belong to this Location. 
|directions |<<types.asciidoc#types_displaytext_class,DisplayText>> |* |Human-readable directions on how to reach the location. 
|operator |<<mod_locations_businessdetails_class,BusinessDetails>> |? |Information of the operator. When not specified, the information retrieved from the `api_info` endpoint should be used instead. 
|suboperator |<<mod_locations_businessdetails_class,BusinessDetails>> |? |Information of the suboperator if available. 
|owner |<<mod_locations_businessdetails_class,BusinessDetails>> |? |Information of the owner if available. 
|facilities |<<mod_locations_facility_enum,Facility>> |* |Optional list of facilities this charge location directly belongs to. 
|time_zone |<<types.asciidoc#types_string_type,string>>(255) |? |One of IANA tzdata's TZ-values representing the time zone of the location. Examples: "Europe/Oslo", "Europe/Zurich". (http://www.iana.org/time-zones[http://www.iana.org/time-zones]) 
|opening_times |<<mod_locations_hours_class,Hours>> |? |The times when the EVSEs at the location can be accessed for charging. 
|charging_when_closed |boolean |? |Indicates if the EVSEs are still charging outside the opening hours of the location. E.g. when the parking garage closes its barriers over night, is it allowed to charge till the next morning? Default: *true* 
|images |<<mod_locations_image_class,Image>> |* |Links to images related to the location such as photos or logos. 
|energy_mix |<<mod_locations_energymix_class,EnergyMix>> |? |Details on the energy supplied at this location. 
|last_updated |<<types.asciidoc#types_datetime_type,DateTime>> |1 |Timestamp when this Location or one of its EVSEs or Connectors were last updated (or created). 
|===


[[mod_locations_example]]
===== Example

[source,json]
----
{
	"id": "LOC1",
	"type": "ON_STREET",
	"name": "Gent Zuid",
	"address": "F.Rooseveltlaan 3A",
	"city": "Gent",
	"postal_code": "9000",
	"country": "BEL",
	"coordinates": {
		"latitude": "51.047599",
		"longitude": "3.729944"
	},
	"evses": [{
        "uid": "3256",
		"evse_id": "BE*BEC*E041503001",
		"status": "AVAILABLE",
		"status_schedule": [],
		"capabilities": [
			"RESERVABLE"
		],
		"connectors": [{
			"id": "1",
			"standard": "IEC_62196_T2",
			"format": "CABLE",
			"power_type": "AC_3_PHASE",
			"voltage": 220,
			"amperage": 16,
			"tariff_id": "11",
            "last_updated": "2015-03-16T10:10:02Z"
		}, {
			"id": "2",
			"standard": "IEC_62196_T2",
			"format": "SOCKET",
			"power_type": "AC_3_PHASE",
			"voltage": 220,
			"amperage": 16,
			"tariff_id": "11",
        	"last_updated": "2015-03-18T08:12:01Z"
		}],
		"physical_reference": "1",
		"floor_level": "-1",
     	"last_updated": "2015-06-28T08:12:01Z"
	}, {
        "uid": "3257",
		"evse_id": "BE*BEC*E041503002",
		"status": "RESERVED",
		"capabilities": [
			"RESERVABLE"
		],
		"connectors": [{
			"id": "1",
			"standard": "IEC_62196_T2",
			"format": "SOCKET",
			"power_type": "AC_3_PHASE",
			"voltage": 220,
			"amperage": 16,
			"tariff_id": "12",
			"last_updated": "2015-06-29T20:39:09Z"
		}],
		"physical_reference": "2",
		"floor_level": "-2",
     	"last_updated": "2015-06-29T20:39:09Z"
	}],
	"operator": {
		"name": "BeCharged"
	},
	"last_updated": "2015-06-29T20:39:09Z"
}
----

[[mod_locations_evse_object]]
==== _EVSE_ Object

The _EVSE_ object describes the part that controls the power supply to a single EV in a single session. It always belongs to a _Location_ object. It will only contain directions to get from the location to the EVSE (i.e. _floor_, _physical_reference_ or _directions_). When these properties are insufficient to reach the EVSE from the _Location_ point, then it typically indicates that this EVSE should be put in a different _Location_ object (sometimes with the same address but with different coordinates/directions).

An _EVSE_ object has a list of connectors which can not be used simultaneously: only one connector per EVSE can be used at the time.

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description 

|uid |<<types.asciidoc#types_string_type,string>>(39) |1 |Uniquely identifies the EVSE within the CPOs platform (and suboperator platforms). For example a database unique ID or the "EVSE ID". This field can never be changed, modified or renamed. This is the 'technical' identification of the EVSE, not to be used as 'human readable' identification, use the field: evse_id for that.
|evse_id |<<types.asciidoc#types_string_type,string>>(48) |? |Compliant with the following specification for EVSE ID from "eMI3 standard version V1.0" (http://emi3group.com/documents-links/[http://emi3group.com/documents-links/]) "Part 2: business objects." Optional because: if an EVSE ID is to be re-used the EVSE ID can be removed from an EVSE that is removed (status: REMOVED) 
|status |<<mod_locations_status_enum,Status>> |1 |Indicates the current status of the EVSE. 
|status_schedule |<<mod_locations_statusschedule_class,StatusSchedule>> |* |Indicates a planned status in the future of the EVSE. 
|capabilities |<<mod_locations_capability_enum,Capability>> |* |List of functionalities that the EVSE is capable of. 
|connectors |<<mod_locations_connector_object,Connector>> |+ |List of available connectors on the EVSE. 
|floor_level |<<types.asciidoc#types_string_type,string>>(4) |? |Level on which the charging station is located (in garage buildings) in the locally displayed numbering scheme. 
|coordinates |<<mod_locations_geolocation_class,GeoLocation>> |? |Coordinates of the EVSE. 
|physical_reference |<<types.asciidoc#types_string_type,string>>(16) |? |A number/string printed on the outside of the EVSE for visual identification. 
|directions |<<types.asciidoc#types_displaytext_class,DisplayText>> |* |Multi-language human-readable directions when more detailed information on how to reach the EVSE from the _Location_ is required. 
|parking_restrictions |<<mod_locations_parkingrestriction_enum,ParkingRestriction>> |* |The restrictions that apply to the parking spot. 
|images |<<mod_locations_image_class,Image>> |* |Links to images related to the EVSE such as photos or logos. 
|last_updated |<<types.asciidoc#types_datetime_type,DateTime>> |1 |Timestamp when this EVSE or one of its Connectors was last updated (or created). 
|===


[[mod_locations_connector_object]]
==== _Connector_ Object

A connector is the socket or cable available for the EV to use. A single EVSE may provide multiple connectors but only one of them can be in use at the same time. A connector always belongs to an _EVSE_ object.

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description 

|id |<<types.asciidoc#types_string_type,string>>(36) |1 |Identifier of the connector within the EVSE. Two connectors may have the same id as long as they do not belong to the same _EVSE_ object. 
|standard |<<mod_locations_connectortype_enum,ConnectorType>> |1 |The standard of the installed connector. 
|format |<<mod_locations_connectorformat_enum,ConnectorFormat>> |1 |The format (socket/cable) of the installed connector. 
|power_type |<<mod_locations_powertype_enum,PowerType>> |1 | 
|voltage |int |1 |Voltage of the connector (line to neutral for AC_3_PHASE), in volt [V]. 
|amperage |int |1 |maximum amperage of the connector, in ampere [A]. 
|tariff_ids |<<types.asciidoc#types_string_type,string>>(36) |* |Identifiers of the current valid charging tariffs. Multiple tariffs are possible, but each require a unique Tariff.type, duplicates not allowed. +
                                                              When Preference based Smart Charging is supported, on tariff for every possible <<mod_sessions.asciidoc#mod_sessions_profile_type_enum,ProfileType>> should be provided, these tell the Driver the options he has at this Connector, and what the tariff is for every option. +
                                                              For a "Free of Charge" tariff this field should be set, and point to a defined "Free of Charge" tariff.
|terms_and_conditions |<<types.asciidoc#types_url_type,URL>> |? |URL to the operator's terms and conditions. 
|last_updated |<<types.asciidoc#types_datetime_type,DateTime>> |1 |Timestamp when this Connectors was last updated (or created). 
|===


[[mod_locations_data_types]]
=== Data types

[[mod_locations_additionalgeolocation_class]]
==== AdditionalGeoLocation _class_

This class defines a geo location. The geodetic system to be used is WGS 84.

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description 

|latitude |<<types.asciidoc#types_string_type,string>>(10) |1 |Latitude of the point in decimal degree. Example: 50.770774. Decimal separator: "." Regex: `-?[0-9]{1,2}\.[0-9]{6}` 
|longitude |<<types.asciidoc#types_string_type,string>>(11) |1 |Longitude of the point in decimal degree. Example: -126.104965. Decimal separator: "." Regex: `-?[0-9]{1,3}\.[0-9]{6}` 
|name |<<types.asciidoc#types_displaytext_class,DisplayText>> |? |Name of the point in local language or as written at the location. For example the street name of a parking lot entrance or it's number. 
|===

[[mod_locations_businessdetails_class]]
==== BusinessDetails _class_

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description 

|name |<<types.asciidoc#types_string_type,string>>(100) |1 |Name of the operator. 
|website |<<types.asciidoc#types_url_type,URL>> |? |Link to the operator's website. 
|logo |<<mod_locations_image_class,Image>> |? |Image link to the operator's logo. 
|===


[[mod_locations_capability_enum]]
==== Capability _enum_

The capabilities of an EVSE.

[cols="3,10",options="header"]
|===
|Value |Description 

|CHARGING_PROFILE_CAPABLE |The EVSE supports charging profiles.
|CHARGING_PREFERENCES_CAPABLE |The EVSE supports <<mod_sessions.asciidoc#mod_sessions_set_charging_preferences,charging preferences>>.
|CREDIT_CARD_PAYABLE |Charging at this EVSE can be payed with a credit card.
|DEBIT_CARD_PAYABLE |Charging at this EVSE can be payed with a debit card.
|REMOTE_START_STOP_CAPABLE |The EVSE can remotely be <<mod_commands.asciidoc#mod_commands_startsession_object,started>>/<<mod_commands.asciidoc#mod_commands_stopsession_object,stopped>>.
|RESERVABLE |The EVSE can be <<mod_commands.asciidoc#mod_commands_reservenow_object,reserved>>.
|RFID_READER |Charging at this EVSE can be authorized with a RFID token 
|UNLOCK_CAPABLE |Connectors have mechanical lock that can be requested by the eMSP to be <<mod_commands.asciidoc#mod_commands_unlockconnector_object,unlocked>>.
|===


[[mod_locations_connectorformat_enum]]
==== ConnectorFormat _enum_

The format of the connector, whether it is a socket or a plug.

[cols="3,10",options="header"]
|===
|Value |Description 

|SOCKET |The connector is a socket; the EV user needs to bring a fitting plug. 
|CABLE |The connector is an attached cable; the EV users car needs to have a fitting inlet. 
|===

[[mod_locations_connectortype_enum]]
==== ConnectorType _enum_

The socket or plug standard of the charging point.

[cols="3,10",options="header"]
|===
|Value |Description 

|CHADEMO |The connector type is CHAdeMO, DC 
|DOMESTIC_A |Standard/Domestic household, type "A", NEMA 1-15, 2 pins 
|DOMESTIC_B |Standard/Domestic household, type "B", NEMA 5-15, 3 pins 
|DOMESTIC_C |Standard/Domestic household, type "C", CEE 7/17, 2 pins 
|DOMESTIC_D |Standard/Domestic household, type "D", 3 pin 
|DOMESTIC_E |Standard/Domestic household, type "E", CEE 7/5 3 pins 
|DOMESTIC_F |Standard/Domestic household, type "F", CEE 7/4, Schuko, 3 pins 
|DOMESTIC_G |Standard/Domestic household, type "G", BS 1363, Commonwealth, 3 pins 
|DOMESTIC_H |Standard/Domestic household, type "H", SI-32, 3 pins 
|DOMESTIC_I |Standard/Domestic household, type "I", AS 3112, 3 pins 
|DOMESTIC_J |Standard/Domestic household, type "J", SEV 1011, 3 pins 
|DOMESTIC_K |Standard/Domestic household, type "K", DS 60884-2-D1, 3 pins 
|DOMESTIC_L |Standard/Domestic household, type "L", CEI 23-16-VII, 3 pins 
|IEC_60309_2_single_16 |IEC 60309-2 Industrial Connector single phase 16 Amperes (usually blue) 
|IEC_60309_2_three_16 |IEC 60309-2 Industrial Connector three phase 16 Amperes (usually red) 
|IEC_60309_2_three_32 |IEC 60309-2 Industrial Connector three phase 32 Amperes (usually red) 
|IEC_60309_2_three_64 |IEC 60309-2 Industrial Connector three phase 64 Amperes (usually red) 
|IEC_62196_T1 |IEC 62196 Type 1 "SAE J1772" 
|IEC_62196_T1_COMBO |Combo Type 1 based, DC 
|IEC_62196_T2 |IEC 62196 Type 2 "Mennekes" 
|IEC_62196_T2_COMBO |Combo Type 2 based, DC 
|IEC_62196_T3A |IEC 62196 Type 3A 
|IEC_62196_T3C |IEC 62196 Type 3C "Scame" 
|TESLA_R |Tesla Connector "Roadster"-type (round, 4 pin) 
|TESLA_S |Tesla Connector "Model-S"-type (oval, 5 pin) 
|===

[[mod_locations_energymix_class]]
==== EnergyMix _class_

This type is used to specify the energy mix and environmental impact of the supplied energy at a location or in a tariff.

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description 

|is_green_energy |boolean |1 |True if 100% from regenerative sources. (CO2 and nuclear waste is zero) 
|energy_sources |<<mod_locations_energysource_class,EnergySource>> |* |Key-value pairs (enum + percentage) of energy sources of this location's tariff. 
|environ_impact |<<mod_locations_environmentalimpact_class,EnvironmentalImpact>> |* |Key-value pairs (enum + percentage) of nuclear waste and CO2 exhaust of this location's tariff. 
|supplier_name |<<types.asciidoc#types_string_type,string>>(64) |? |Name of the energy supplier, delivering the energy for this location or tariff.* 
|energy_product_name |<<types.asciidoc#types_string_type,string>>(64) |? |Name of the energy suppliers product/tariff plan used at this location.* 
|===

_* These fields can be used to look-up energy qualification or to show it directly to the customer (for well-known brands like Greenpeace Energy, etc.)_

[[mod_locations_examples]]
===== Examples

[[mod_locations_simple]]
====== Simple:

[source,json]
----
"energy_mix": {
	"is_green_energy": true
    }
----

[[mod_locations_energy_provider_name]]
====== Tariff energy provider name:

[source,json]
----
"energy_mix": {
	"is_green_energy":     true,
	"supplier_name":       "Greenpeace Energy eG",
	"energy_product_name": "eco-power"
    }
----

[[mod_locations_complete]]
====== Complete:

[source,json]
----
"energy_mix": {
	"is_green_energy": false,
	"energy_sources": [
			{ "source": "GENERAL_GREEN",  "percentage": 35.9 },
			{ "source": "GAS",            "percentage": 6.3  },
			{ "source": "COAL",           "percentage": 33.2 },
			{ "source": "GENERAL_FOSSIL", "percentage": 2.9, },
			{ "source": "NUCLEAR",        "percentage": 21.7 }
		],
	"environ_impact": [
			{ "source": "NUCLEAR_WASTE",  "amount": 0.0006,  },
			{ "source": "CARBON_DIOXIDE", "amount": 372,     }
		],
	"supplier_name":       "E.ON Energy Deutschland",
	"energy_product_name": "E.ON DirektStrom eco"
    }
----

[[mod_locations_energysource_class]]
==== EnergySource _class_

Key-value pairs (enum + percentage) of energy sources. All given values should add up to 100 percent per category.

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description 

|source |<<mod_locations_energysourcecategory_enum,EnergySourceCategory>> |1 |The type of energy source. 
|percentage |<<types.asciidoc#types_number_type,number>> |1 |Percentage of this source (0-100) in the mix. 
|===

[[mod_locations_energysourcecategory_enum]]
==== EnergySourceCategory _enum_

Categories of energy sources.

[cols="3,10",options="header"]
|===
|Value |Description 

|NUCLEAR |Nuclear power sources. 
|GENERAL_FOSSIL |All kinds of fossil power sources. 
|COAL |Fossil power from coal. 
|GAS |Fossil power from gas. 
|GENERAL_GREEN |All kinds of regenerative power sources. 
|SOLAR |Regenerative power from PV. 
|WIND |Regenerative power from wind turbines. 
|WATER |Regenerative power from water turbines. 
|===

[[mod_locations_environmentalimpact_class]]
==== EnvironmentalImpact _class_

Key-value pairs (enum + amount) of waste and carbon dioxide emittion per kWh.

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description 

|source |<<mod_locations_environmentalimpactcategory_enum,EnvironmentalImpactCategory>> |1 |The category of this value. 
|amount |<<types.asciidoc#types_number_type,number>> |1 |Amount of this portion in g/kWh. 
|===

[[mod_locations_environmentalimpactcategory_enum]]
==== EnvironmentalImpactCategory _enum_

Categories of environmental impact values.

[cols="3,10",options="header"]
|===
|Value |Description 

|NUCLEAR_WASTE |Produced nuclear waste in gramms per kilowatthour. 
|CARBON_DIOXIDE |Exhausted carbon dioxide in gramms per kilowarrhour. 
|===

[[mod_locations_exceptionalperiod_class]]
==== ExceptionalPeriod _class_

Specifies one exceptional period for opening or access hours.

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description

|period_begin |<<types.asciidoc#types_datetime_type,DateTime>> |1 |Begin of the exception.
|period_end |<<types.asciidoc#types_datetime_type,DateTime>> |1 |End of the exception.
|===


[[mod_locations_facility_enum]]
==== Facility _enum_

[cols="3,10",options="header"]
|===
|Value |Description 

|HOTEL |A hotel. 
|RESTAURANT |A restaurant. 
|CAFE |A cafe. 
|MALL |A mall or shopping center. 
|SUPERMARKET |A supermarket. 
|SPORT |Sport facilities: gym, field etc. 
|RECREATION_AREA |A Recreation area. 
|NATURE |Located in, or close to, a park, nature reserve/park etc. 
|MUSEUM |A museum. 
|BUS_STOP |A bus stop. 
|TAXI_STAND |A taxi stand. 
|TRAIN_STATION |A train station. 
|AIRPORT |An airport. 
|CARPOOL_PARKING |A carpool parking. 
|FUEL_STATION |A Fuel station. 
|WIFI |Wifi or other type of internet available. 
|===

[[mod_locations_geolocation_class]]
==== GeoLocation _class_

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description 

|latitude |<<types.asciidoc#types_string_type,string>>(10) |1 |Latitude of the point in decimal degree. Example: 50.770774. Decimal separator: "." Regex: `-?[0-9]{1,2}\.[0-9]{6}` 
|longitude |<<types.asciidoc#types_string_type,string>>(11) |1 |Longitude of the point in decimal degree. Example: -126.104965. Decimal separator: "." Regex: `-?[0-9]{1,3}\.[0-9]{6}` 
|===

[[mod_locations_hours_class]]
==== Hours _class_

Opening and access hours of the location.

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description

|twentyfourseven |boolean |1 |True to represent 24 hours a day and 7 days a week, except the given exceptions. 
|regular_hours |<<mod_locations_regularhours_class,RegularHours>> |* |Regular hours, weekday-based. Only to be used if `twentyfourseven=false`. 
|exceptional_openings |<<mod_locations_exceptionalperiod_class,ExceptionalPeriod>> |* |Exceptions for specified calendar dates, time-range based. Periods the station is operating/accessible. Additional to regular hours. May overlap regular rules. 
|exceptional_closings |<<mod_locations_exceptionalperiod_class,ExceptionalPeriod>> |* |Exceptions for specified calendar dates, time-range based. Periods the station is not operating/accessible. Overwriting regularHours and exceptionalOpenings. Should not overlap exceptionalOpenings. 
|===

[[mod_locations_image_class]]
==== Image _class_

This class references images related to a EVSE in terms of a file name or url. According to the roaming connection between one EVSE Operator and one or more Navigation Service Providers the hosting or file exchange of image payload data has to be defined. The exchange of this content data is out of scope of OCHP. However, the recommended setup is a public available web server hosted and updated by the EVSE Operator. Per charge point an unlimited number of images of each type is allowed. Recommended are at least two images where one is a network or provider logo and the second is a station photo. If two images of the same type are defined they should be displayed additionally, not optionally.

Photo Dimensions:
The recommended dimensions for all photos is a minimum of 800 pixels wide and 600 pixels height. Thumbnail representations for photos should always have the same orientation as the original with a size of 200 to 200 pixels.

Logo Dimensions:
The recommended dimensions for logos are exactly 512 pixels wide and 512 pixels height. Thumbnail representations for logos should be exactly 128 pixels in width and height. If not squared, thumbnails should have the same orientation as the original.

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description

|url |<<types.asciidoc#types_url_type,URL>> |1 |URL from where the image data can be fetched through a web browser. 
|thumbnail |<<types.asciidoc#types_url_type,URL>> |? |URL from where a thumbnail of the image can be fetched through a webbrowser. 
|category |<<mod_locations_imagecategory_enum,ImageCategory>> |1 |Describes what the image is used for. 
|type |<<types.asciidoc#types_string_type,string>>(4) |1 |Image type like: gif, jpeg, png, svg 
|width |int(5) |? |Width of the full scale image 
|height |int(5) |? |Height of the full scale image 
|===

[[mod_locations_imagecategory_enum]]
==== ImageCategory _enum_

The category of an image to obtain the correct usage in a user presentation. The category has to be set accordingly to the image content in order to guarantee the right usage.

[cols="3,10",options="header"]
|===
|Value |Description 

|CHARGER |Photo of the physical device that contains one or more EVSEs. 
|ENTRANCE |Location entrance photo. Should show the car entrance to the location from street side. 
|LOCATION |Location overview photo. 
|NETWORK |logo of an associated roaming network to be displayed with the EVSE for example in lists, maps and detailed information view 
|OPERATOR |logo of the charge points operator, for example a municipality, to be displayed with the EVSEs detailed information view or in lists and maps, if no networkLogo is present 
|OTHER |Other 
|OWNER |logo of the charge points owner, for example a local store, to be displayed with the EVSEs detailed information view 
|===

[[mod_locations_locationtype_enum]]
==== LocationType _enum_

Reflects the general type of the charge points location. May be used
for user information.

[cols="3,10",options="header"]
|===
|Value |Description 

|ON_STREET |Parking in public space. 
|PARKING_GARAGE |Multistorey car park. 
|UNDERGROUND_GARAGE |Multistorey car park, mainly underground. 
|PARKING_LOT |A cleared area that is intended for parking vehicles, i.e. at super markets, bars, etc.
|OTHER |None of the given possibilities. 
|UNKNOWN |Parking location type is not known by the operator (default). 
|===

[[mod_locations_parkingrestriction_enum]]
==== ParkingRestriction _enum_

This value, if provided, represents the restriction to the parking spot
for different purposes.

[cols="3,10",options="header"]
|===
|Value |Description 

|EV_ONLY |Reserved parking spot for electric vehicles. 
|PLUGGED |Parking is only allowed while plugged in (charging). 
|DISABLED |Reserved parking spot for disabled people with valid ID. 
|CUSTOMERS |Parking spot for customers/guests only, for example in case of a hotel or shop.
|MOTORCYCLES |Parking spot only suitable for (electric) motorcycles or scooters. 
|===

[[mod_locations_powertype_enum]]
==== PowerType _enum_

[cols="3,10",options="header"]
|===
|Value |Description 

|AC_1_PHASE |AC mono phase. 
|AC_3_PHASE |AC 3 phase. 
|DC |Direct Current. 
|===

[[mod_locations_regularhours_class]]
==== RegularHours _class_

Regular recurring operation or access hours

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description

|weekday |int(1) |1 |Number of day in the week, from Monday (1) till Sunday (7) 
|period_begin |<<types.asciidoc#types_string_type,string>>(5) |1 |Begin of the regular period given in hours and minutes. Must be in 24h format with leading zeros. Example: "18:15". Hour/Minute separator: ":" Regex: [0-2][0-9]:[0-5][0-9]
|period_end |<<types.asciidoc#types_string_type,string>>(5) |1 |End of the regular period, syntax as for period_begin. Must be later than period_begin.
|===

[[mod_locations_example_a]]
===== Example

Operating on weekdays from 8am till 8pm with one exceptional opening on
22/6/2014 and one exceptional closing the Monday after:

[source,json]
----
  "opening_times": {
    "regular_hours": [
      {
        "weekday": 1,
        "period_begin": "08:00",
        "period_end": "20:00"
      },
      {
        "weekday": 2,
        "period_begin": "08:00",
        "period_end": "20:00"
      },
      {
        "weekday": 3,
        "period_begin": "08:00",
        "period_end": "20:00"
      },
      {
        "weekday": 4,
        "period_begin": "08:00",
        "period_end": "20:00"
      },
      {
        "weekday": 5,
        "period_begin": "08:00",
        "period_end": "20:00"
      }
    ],
    "twentyfourseven": false,
    "exceptional_openings": [
      {
        "period_begin": "2014-06-21T09:00:00Z",
        "period_end": "2014-06-21T12:00:00Z"
      }
    ],
    "exceptional_closings": [
      {
        "period_begin": "2014-06-24T00:00:00Z",
        "period_end": "2014-06-25T00:00:00Z"
      }
    ]
  }
----

This represents the following schedule, where [line-through]#stroked out# days are without operation hours, *bold* days are where exceptions apply and regular displayed days are where the regular schedule applies.

|===
|Weekday |Mo |Tu |We |Th |Fr |Sa |Su |Mo |Tu |We |Th |Fr |Sa |Su 

|Date |16 |17 |18 |19 |20 |*21* |[line-through]#22# |23 |*[line-through]#24#* |25 |26 |27 |[line-through]#28# |[line-through]#29# 
|Open from |08 |08 |08 |08 |08 |09 |`-` |08 |`-` |08 |08 |08 |`-` |`-` 
|Open till |20 |20 |20 |20 |20 |12 |`-` |20 |`-` |20 |20 |20 |`-` |`-` 
|===

[[mod_locations_status_enum]]
==== Status _enum_

The status of an EVSE.

[cols="3,10",options="header"]
|===
|Value |Description 

|AVAILABLE |The EVSE/Connector is able to start a new charging session. 
|BLOCKED |The EVSE/Connector is not accessible because of a physical barrier, i.e. a car. 
|CHARGING |The EVSE/Connector is in use. 
|INOPERATIVE |The EVSE/Connector is not yet active or it is no longer available (deleted). 
|OUTOFORDER |The EVSE/Connector is currently out of order. 
|PLANNED |The EVSE/Connector is planned, will be operating soon 
|REMOVED |The EVSE/Connector/charge point is discontinued/removed. 
|RESERVED |The EVSE/Connector is reserved for a particular EV driver and is unavailable for other drivers. 
|UNKNOWN |No status information available. (Also used when offline) 
|===

[[mod_locations_statusschedule_class]]
==== StatusSchedule _class_

This type is used to schedule status periods in the future. The eMSP can provide this information to the EV user for trip planning purpose. A period MAY have no end. Example: "This station will be running as of tomorrow. Today it is still planned and under construction."

[cols="3,2,1,10",options="header"]
|===
|Property |Type |Card. |Description 

|period_begin |<<types.asciidoc#types_datetime_type,DateTime>> |1 |Begin of the scheduled period. 
|period_end |<<types.asciidoc#types_datetime_type,DateTime>> |? |End of the scheduled period, if known. 
|status |<<mod_locations_status_enum,Status>> |1 |Status value during the scheduled period. 
|===

Note that the scheduled status is purely informational. When the status actually changes, the CPO must push an update to the EVSEs `status` field itself.